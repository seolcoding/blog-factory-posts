---
/**
 * TimelineItem - Display chronological events
 *
 * @example
 * <TimelineItem
 *   date="2024"
 *   title="Company Founded"
 *   description="Started our journey with a small team of 3"
 * />
 *
 * <TimelineItem
 *   date="March 2024"
 *   title="Series A Funding"
 *   description="Raised $10M to expand operations"
 *   variant="accent"
 *   isLast={false}
 * />
 */

export interface Props {
  /** Date or time label */
  date: string;
  /** Event title */
  title: string;
  /** Event description */
  description?: string;
  /** Optional icon (svg path or "dot") */
  icon?: string;
  /** Visual variant */
  variant?: "default" | "accent" | "success" | "warning";
  /** Whether this is the last item (hides the connector line) */
  isLast?: boolean;
  /** Additional CSS classes */
  class?: string;
}

const {
  date,
  title,
  description,
  icon,
  variant = "default",
  isLast = false,
  class: className = "",
} = Astro.props;

const variantStyles = {
  default: {
    dot: "bg-muted-foreground",
    ring: "ring-muted",
    line: "bg-border",
  },
  accent: {
    dot: "bg-accent",
    ring: "ring-accent/30",
    line: "bg-accent/30",
  },
  success: {
    dot: "bg-success",
    ring: "ring-success/30",
    line: "bg-success/30",
  },
  warning: {
    dot: "bg-warning",
    ring: "ring-warning/30",
    line: "bg-warning/30",
  },
};

const styles = variantStyles[variant];
---

<div class:list={["relative flex gap-4", className]}>
  <!-- Timeline indicator -->
  <div class="flex flex-col items-center">
    <!-- Dot/Icon -->
    <div
      class:list={[
        "relative z-10 flex h-4 w-4 items-center justify-center rounded-full ring-4",
        styles.dot,
        styles.ring,
      ]}
    >
      {
        icon && icon !== "dot" && (
          <svg
            class="h-2.5 w-2.5 text-white"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="3"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d={icon} />
          </svg>
        )
      }
    </div>

    <!-- Connector line -->
    {
      !isLast && (
        <div
          class:list={[
            "flex-1 w-0.5 mt-2",
            styles.line,
          ]}
        />
      )
    }
  </div>

  <!-- Content -->
  <div class:list={["pb-8", isLast ? "pb-0" : ""]}>
    <!-- Date badge -->
    <time
      class="inline-block px-2 py-0.5 text-xs font-medium bg-muted text-muted-foreground rounded mb-2"
    >
      {date}
    </time>

    <!-- Title -->
    <h4 class="text-base font-semibold text-foreground mb-1">
      {title}
    </h4>

    <!-- Description -->
    {
      description && (
        <p class="text-sm text-muted-foreground leading-relaxed">
          {description}
        </p>
      )
    }

    <!-- Slot for additional content -->
    <slot />
  </div>
</div>
